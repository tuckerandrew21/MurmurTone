<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MurmurTone Settings</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="window">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="sidebar-logo-container">
                <img src="assets/logo.png" alt="MurmurTone" class="sidebar-logo">
            </div>
            <h1 class="sidebar-title">Settings</h1>

            <div class="nav-items">
                <button class="nav-item active" data-page="general">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                    </svg>
                    <span>General</span>
                </button>

                <button class="nav-item" data-page="audio">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                        <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                        <line x1="12" y1="19" x2="12" y2="23"/>
                        <line x1="8" y1="23" x2="16" y2="23"/>
                    </svg>
                    <span>Audio</span>
                </button>

                <button class="nav-item" data-page="recognition">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="12 2 2 7 12 12 22 7 12 2"/>
                        <polyline points="2 17 12 22 22 17"/>
                        <polyline points="2 12 12 17 22 12"/>
                    </svg>
                    <span>Recognition</span>
                </button>

                <button class="nav-item" data-page="text">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="4 7 4 4 20 4 20 7"/>
                        <line x1="9" y1="20" x2="15" y2="20"/>
                        <line x1="12" y1="4" x2="12" y2="20"/>
                    </svg>
                    <span>Text</span>
                </button>

                <button class="nav-item" data-page="advanced">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                    </svg>
                    <span>Advanced</span>
                </button>

                <button class="nav-item" data-page="about">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="16" x2="12" y2="12"/>
                        <line x1="12" y1="8" x2="12.01" y2="8"/>
                    </svg>
                    <span>About</span>
                </button>
            </div>

            <div class="sidebar-spacer"></div>

            <div class="sidebar-footer">
                <div class="save-status" id="save-status"></div>
                <div class="version-text" id="version-text">MurmurTone v1.0.0</div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="content">
            <div class="content-body">
                <header class="content-header">
                    <h2 class="page-title" id="page-title">General</h2>
                </header>
                <!-- General Page -->
                <section class="page active" id="page-general">
                    <!-- Recording Section -->
                    <div class="settings-section">
                        <h3 class="section-title">Recording</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Activation Hotkey</label>
                                <p class="setting-help">Press your preferred key combination to start recording.</p>
                            </div>
                            <button type="button" id="hotkey-capture" class="hotkey-capture-btn" data-testid="hotkey-capture">
                                <span class="hotkey-display">Ctrl + Shift + Space</span>
                            </button>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Recording Mode</label>
                                <p class="setting-help">How recording starts and stops.</p>
                            </div>
                            <div id="recording-mode" class="custom-dropdown" aria-label="Recording mode" data-testid="recording-mode">
                                <button type="button" class="custom-dropdown-button" aria-haspopup="listbox">
                                    <span class="custom-dropdown-value">Auto Stop</span>
                                    <svg class="custom-dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </button>
                                <div class="custom-dropdown-menu" role="listbox">
                                    <div class="custom-dropdown-option" data-value="push_to_talk" role="option">Push to Talk</div>
                                    <div class="custom-dropdown-option" data-value="toggle" role="option">Toggle</div>
                                    <div class="custom-dropdown-option selected" data-value="auto_stop" role="option">Auto Stop</div>
                                </div>
                            </div>
                        </div>

                        <div class="child-settings" id="auto-stop-options">
                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Silence Sensitivity</label>
                                    <p class="setting-help">How much quieter than speech to trigger auto-stop. Higher = more sensitive.</p>
                                </div>
                                <div class="slider-row">
                                    <input type="range" id="silence-threshold" class="slider"
                                        min="-40" max="-10" step="5" value="-20"
                                        aria-label="Silence sensitivity"
                                        data-testid="silence-threshold">
                                    <span class="slider-value" id="silence-threshold-value">-20 dB</span>
                                </div>
                            </div>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Language</label>
                                <p class="setting-help">Language for speech recognition. Auto-detect works for most cases.</p>
                            </div>
                            <div id="language" class="custom-dropdown" aria-label="Language" data-testid="language">
                                <button type="button" class="custom-dropdown-button" aria-haspopup="listbox">
                                    <span class="custom-dropdown-value">Auto-detect</span>
                                    <svg class="custom-dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </button>
                                <div class="custom-dropdown-menu" role="listbox">
                                    <div class="custom-dropdown-option selected" data-value="auto" role="option">Auto-detect</div>
                                    <div class="custom-dropdown-option" data-value="en" role="option">English</div>
                                    <div class="custom-dropdown-option" data-value="es" role="option">Spanish</div>
                                    <div class="custom-dropdown-option" data-value="fr" role="option">French</div>
                                    <div class="custom-dropdown-option" data-value="de" role="option">German</div>
                                    <div class="custom-dropdown-option" data-value="it" role="option">Italian</div>
                                    <div class="custom-dropdown-option" data-value="pt" role="option">Portuguese</div>
                                    <div class="custom-dropdown-option" data-value="nl" role="option">Dutch</div>
                                    <div class="custom-dropdown-option" data-value="pl" role="option">Polish</div>
                                    <div class="custom-dropdown-option" data-value="ru" role="option">Russian</div>
                                    <div class="custom-dropdown-option" data-value="zh" role="option">Chinese</div>
                                    <div class="custom-dropdown-option" data-value="ja" role="option">Japanese</div>
                                    <div class="custom-dropdown-option" data-value="ko" role="option">Korean</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Output Section -->
                    <div class="settings-section">
                        <h3 class="section-title">Output</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Auto-paste</label>
                                <p class="setting-help">Automatically paste transcribed text into the active application.</p>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="auto-paste" aria-label="Auto-paste" data-testid="auto-paste">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Paste Mode</label>
                                <p class="setting-help" id="paste-mode-help">How text is inserted: clipboard paste or simulated typing.</p>
                            </div>
                            <div id="paste-mode" class="custom-dropdown" aria-label="Paste mode" data-testid="paste-mode">
                                <button type="button" class="custom-dropdown-button" aria-haspopup="listbox">
                                    <span class="custom-dropdown-value">Clipboard (Ctrl+V)</span>
                                    <svg class="custom-dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </button>
                                <div class="custom-dropdown-menu" role="listbox">
                                    <div class="custom-dropdown-option selected" data-value="clipboard" role="option">Clipboard (Ctrl+V)</div>
                                    <div class="custom-dropdown-option" data-value="direct" role="option">Direct Typing</div>
                                </div>
                            </div>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Preview Window</label>
                                <p class="setting-help">Display transcription in a floating overlay before pasting.</p>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="preview-enabled" aria-label="Preview enabled" data-testid="preview-enabled">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="child-settings" id="preview-options">
                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Position</label>
                                    <p class="setting-help">Where the preview window appears on screen.</p>
                                </div>
                                <div id="preview-position" class="custom-dropdown" aria-label="Preview position" data-testid="preview-position">
                                    <button type="button" class="custom-dropdown-button" aria-haspopup="listbox">
                                        <span class="custom-dropdown-value">Near Cursor</span>
                                        <svg class="custom-dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                    </button>
                                    <div class="custom-dropdown-menu" role="listbox">
                                        <div class="custom-dropdown-option selected" data-value="cursor" role="option">Near Cursor</div>
                                        <div class="custom-dropdown-option" data-value="center" role="option">Center Screen</div>
                                        <div class="custom-dropdown-option" data-value="top_right" role="option">Top Right</div>
                                        <div class="custom-dropdown-option" data-value="bottom_right" role="option">Bottom Right</div>
                                    </div>
                                </div>
                            </div>

                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Auto-hide Delay</label>
                                    <p class="setting-help">Seconds before the preview window automatically closes.</p>
                                </div>
                                <div class="slider-row">
                                    <input type="range" id="preview-auto-hide" class="slider"
                                        min="1" max="10" step="0.5" value="3"
                                        aria-label="Preview auto-hide delay"
                                        data-testid="preview-auto-hide">
                                    <span class="slider-value" id="preview-auto-hide-value">3s</span>
                                </div>
                            </div>

                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Theme</label>
                                    <p class="setting-help">Visual style for the preview window.</p>
                                </div>
                                <div id="preview-theme" class="custom-dropdown" aria-label="Preview theme" data-testid="preview-theme">
                                    <button type="button" class="custom-dropdown-button" aria-haspopup="listbox">
                                        <span class="custom-dropdown-value">Dark</span>
                                        <svg class="custom-dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                    </button>
                                    <div class="custom-dropdown-menu" role="listbox">
                                        <div class="custom-dropdown-option selected" data-value="dark" role="option">Dark</div>
                                        <div class="custom-dropdown-option" data-value="light" role="option">Light</div>
                                    </div>
                                </div>
                            </div>

                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Font Size</label>
                                    <p class="setting-help">Text size in the preview window.</p>
                                </div>
                                <div class="slider-row">
                                    <input type="range" id="preview-font-size" class="slider"
                                        min="8" max="18" step="1" value="13"
                                        aria-label="Preview font size"
                                        data-testid="preview-font-size">
                                    <span class="slider-value" id="preview-font-size-value">13pt</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Audio Page -->
                <section class="page" id="page-audio">
                    <!-- Input Device Section -->
                    <div class="settings-section">
                        <h3 class="section-title">Input Device</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Microphone</label>
                                <p class="setting-help">Select which microphone to use for recording.</p>
                            </div>
                            <div class="input-with-button">
                                <div id="input-device" class="custom-dropdown" data-testid="input-device">
                                    <button type="button" class="custom-dropdown-button" aria-haspopup="listbox">
                                        <span class="custom-dropdown-value">System Default</span>
                                        <svg class="custom-dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                    </button>
                                    <div class="custom-dropdown-menu" role="listbox">
                                        <div class="custom-dropdown-option selected" data-value="" role="option">System Default</div>
                                    </div>
                                </div>
                                <button type="button" id="refresh-devices-btn" class="btn btn-secondary btn-icon" data-testid="refresh-devices-btn" title="Refresh devices">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                        <path d="M23 4v6h-6M1 20v-6h6"/>
                                        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Sample Rate</label>
                                <p class="setting-help">Audio quality setting. 16 kHz is recommended for speech.</p>
                            </div>
                            <div id="sample-rate" class="custom-dropdown" data-testid="sample-rate">
                                <button type="button" class="custom-dropdown-button" aria-haspopup="listbox">
                                    <span class="custom-dropdown-value">16 kHz (Recommended)</span>
                                    <svg class="custom-dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </button>
                                <div class="custom-dropdown-menu" role="listbox">
                                    <div class="custom-dropdown-option selected" data-value="16000" role="option">16 kHz (Recommended)</div>
                                    <div class="custom-dropdown-option" data-value="44100" role="option">44.1 kHz</div>
                                    <div class="custom-dropdown-option" data-value="48000" role="option">48 kHz</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Noise Gate Section -->
                    <div class="settings-section">
                        <h3 class="section-title">Noise Gate</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Enable Noise Gate</label>
                                <p class="setting-help">Filter out background noise below a threshold.</p>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="noise-gate-enabled" data-testid="noise-gate-enabled">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="child-settings" id="noise-gate-options">
                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Threshold</label>
                                    <p class="setting-help">Sound level required to start recording. Drag to adjust.</p>
                                </div>
                                <div class="threshold-meter-container">
                                    <div class="threshold-meter" id="threshold-meter" data-testid="noise-gate-threshold">
                                        <div class="meter-fill" id="audio-level-fill"></div>
                                        <div class="threshold-handle" id="threshold-handle"></div>
                                    </div>
                                    <button type="button" class="btn btn-secondary" id="mic-test-btn">Test</button>
                                </div>
                                <!-- Hidden input for form compatibility -->
                                <input type="hidden" id="noise-gate-threshold" value="-40">
                            </div>
                        </div>
                    </div>

                    <!-- Audio Feedback Section -->
                    <div class="settings-section">
                        <h3 class="section-title">Audio Feedback</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Enable Audio Feedback</label>
                                <p class="setting-help">Master toggle for all sound notifications.</p>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="audio-feedback-enabled" aria-label="Enable audio feedback" data-testid="audio-feedback-enabled">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="child-settings" id="audio-feedback-options">
                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Feedback Volume</label>
                                    <p class="setting-help">Volume level for feedback sounds.</p>
                                </div>
                                <div class="slider-row">
                                    <input type="range" id="feedback-volume" class="slider"
                                        min="0" max="100" value="70"
                                        aria-label="Feedback volume"
                                        data-testid="feedback-volume">
                                    <span class="slider-value" id="feedback-volume-value">70%</span>
                                </div>
                            </div>

                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Processing Sound</label>
                                    <p class="setting-help">Play sound while transcription is processing.</p>
                                </div>
                                <label class="toggle">
                                    <input type="checkbox" id="sound-processing" aria-label="Processing sound" data-testid="sound-processing">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Success Sound</label>
                                    <p class="setting-help">Play sound when transcription completes.</p>
                                </div>
                                <label class="toggle">
                                    <input type="checkbox" id="sound-success" aria-label="Success sound" data-testid="sound-success">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Error Sound</label>
                                    <p class="setting-help">Play sound when an error occurs.</p>
                                </div>
                                <label class="toggle">
                                    <input type="checkbox" id="sound-error" aria-label="Error sound" data-testid="sound-error">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Command Sound</label>
                                    <p class="setting-help">Play sound when a voice command is recognized.</p>
                                </div>
                                <label class="toggle">
                                    <input type="checkbox" id="sound-command" aria-label="Command sound" data-testid="sound-command">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Recognition Page -->
                <section class="page" id="page-recognition">
                    <!-- Speech Recognition Section -->
                    <div class="settings-section">
                        <h3 class="section-title">Speech Recognition</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Model Size</label>
                                <p class="setting-help">Larger models are more accurate but slower.</p>
                            </div>
                            <div class="input-with-button">
                                <div id="model-size" class="custom-dropdown" aria-label="Model size" data-testid="model-size">
                                    <button type="button" class="custom-dropdown-button" aria-haspopup="listbox">
                                        <span class="custom-dropdown-value">Recommended</span>
                                        <svg class="custom-dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                    </button>
                                    <div class="custom-dropdown-menu" role="listbox">
                                        <div class="custom-dropdown-option" data-value="tiny" role="option">Quick</div>
                                        <div class="custom-dropdown-option" data-value="base" role="option">Standard</div>
                                        <div class="custom-dropdown-option selected" data-value="small" role="option">Recommended</div>
                                        <div class="custom-dropdown-option" data-value="medium" role="option">Professional</div>
                                        <div class="custom-dropdown-option" data-value="large-v3" role="option">Studio</div>
                                    </div>
                                </div>
                                <button type="button" id="download-model-btn" class="btn btn-secondary" data-testid="download-model-btn">Download</button>
                            </div>
                        </div>

                        <div class="setting-row toggle-row hidden" id="download-progress-row">
                            <div class="setting-info">
                                <label class="setting-label">Download Progress</label>
                                <p class="setting-help">Downloading model files...</p>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="download-progress"></div>
                            </div>
                            <span class="progress-text" id="download-progress-text">0%</span>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Silence Duration</label>
                                <p class="setting-help">How long to wait for silence before stopping.</p>
                            </div>
                            <div class="slider-row">
                                <input type="range" id="silence-duration" class="slider"
                                    min="0.5" max="5" step="0.5" value="2"
                                    aria-label="Silence duration"
                                    data-testid="silence-duration">
                                <span class="slider-value" id="silence-duration-value">2.0s</span>
                            </div>
                        </div>
                    </div>

                    <!-- Processing Mode Section -->
                    <div class="settings-section">
                        <h3 class="section-title">Processing Mode</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Mode</label>
                                <p class="setting-help">Auto-detect or force CPU/GPU processing.</p>
                            </div>
                            <div id="processing-mode" class="custom-dropdown" aria-label="Processing mode" data-testid="processing-mode">
                                <button type="button" class="custom-dropdown-button" aria-haspopup="listbox">
                                    <span class="custom-dropdown-value">Auto (Recommended)</span>
                                    <svg class="custom-dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </button>
                                <div class="custom-dropdown-menu" role="listbox">
                                    <div class="custom-dropdown-option selected" data-value="auto" role="option">Auto (Recommended)</div>
                                    <div class="custom-dropdown-option" data-value="cpu" role="option">CPU Only</div>
                                    <div class="custom-dropdown-option" data-value="gpu-balanced" role="option">GPU Balanced</div>
                                    <div class="custom-dropdown-option" data-value="gpu-quality" role="option">GPU Quality</div>
                                </div>
                            </div>
                        </div>

                        <div class="setting-row toggle-row" id="gpu-status-row">
                            <div class="setting-info">
                                <label class="setting-label">GPU Status</label>
                                <p class="setting-help">Current GPU availability and CUDA status.</p>
                            </div>
                            <div class="input-with-button">
                                <div class="status-badge success" id="gpu-status">
                                    <span class="status-indicator"></span>
                                    <span class="status-text">CUDA Available</span>
                                </div>
                                <button type="button" id="refresh-gpu-btn" class="btn btn-secondary btn-icon"
                                        title="Refresh status" data-testid="refresh-gpu-btn">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                        <path d="M23 4v6h-6M1 20v-6h6"/>
                                        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div class="setting-row toggle-row hidden" id="install-gpu-row">
                            <div class="setting-info">
                                <label class="setting-label">GPU Libraries</label>
                                <p class="setting-help">Install CUDA libraries for GPU acceleration.</p>
                            </div>
                            <button type="button" id="install-gpu-btn" class="btn btn-primary" data-testid="install-gpu-btn">Install GPU Support</button>
                        </div>
                    </div>

                    <!-- Translation Section -->
                    <div class="settings-section">
                        <h3 class="section-title">Translation</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Enable Translation</label>
                                <p class="setting-help">Translate speech from the source language to English.</p>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="translation-enabled" aria-label="Enable translation" data-testid="translation-enabled">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="child-settings" id="translation-options">
                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Source Language</label>
                                    <p class="setting-help">Language being spoken. Use auto-detect if unsure.</p>
                                </div>
                                <div id="translation-source-language" class="custom-dropdown" aria-label="Source language" data-testid="translation-source-language">
                                    <button type="button" class="custom-dropdown-button" aria-haspopup="listbox">
                                        <span class="custom-dropdown-value">Auto Detect</span>
                                        <svg class="custom-dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                    </button>
                                    <div class="custom-dropdown-menu" role="listbox">
                                        <div class="custom-dropdown-option selected" data-value="auto" role="option">Auto Detect</div>
                                        <div class="custom-dropdown-option" data-value="es" role="option">Spanish</div>
                                        <div class="custom-dropdown-option" data-value="fr" role="option">French</div>
                                        <div class="custom-dropdown-option" data-value="de" role="option">German</div>
                                        <div class="custom-dropdown-option" data-value="it" role="option">Italian</div>
                                        <div class="custom-dropdown-option" data-value="pt" role="option">Portuguese</div>
                                        <div class="custom-dropdown-option" data-value="zh" role="option">Chinese</div>
                                        <div class="custom-dropdown-option" data-value="ja" role="option">Japanese</div>
                                        <div class="custom-dropdown-option" data-value="ko" role="option">Korean</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Text Page -->
                <section class="page" id="page-text">
                    <!-- Voice Commands Section -->
                    <div class="settings-section">
                        <h3 class="section-title">Voice Commands</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Enable Voice Commands</label>
                                <p class="setting-help">Recognize and execute voice commands like "new line" or "period".</p>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="voice-commands" aria-label="Voice commands" data-testid="voice-commands">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="child-settings" id="voice-commands-options">
                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Scratch That</label>
                                    <p class="setting-help">Say "scratch that" to undo the last transcription.</p>
                                </div>
                                <label class="toggle">
                                    <input type="checkbox" id="scratch-that" aria-label="Scratch that" data-testid="scratch-that">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Filler Word Removal Section -->
                    <div class="settings-section">
                        <h3 class="section-title">Filler Word Removal</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Enable Filler Removal</label>
                                <p class="setting-help">Remove common filler words from transcriptions.</p>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="filler-removal" aria-label="Filler removal" data-testid="filler-removal">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="child-settings" id="filler-options">
                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Aggressive Mode</label>
                                    <p class="setting-help">Remove more words including "like", "you know", "basically".</p>
                                </div>
                                <label class="toggle">
                                    <input type="checkbox" id="filler-aggressive" aria-label="Aggressive filler removal" data-testid="filler-aggressive">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Custom Filler Words</label>
                                    <p class="setting-help">Add your own words to filter out.</p>
                                </div>
                                <button type="button" id="edit-fillers-btn" class="btn btn-secondary" data-testid="edit-fillers-btn">
                                    Edit Words
                                    <span class="badge" id="filler-count">0</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Word Customization Section -->
                    <div class="settings-section">
                        <h3 class="section-title">Word Customization</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Custom Vocabulary</label>
                                <p class="setting-help">Words to always recognize correctly (names, jargon).</p>
                            </div>
                            <button type="button" id="edit-vocabulary-btn" class="btn btn-secondary" data-testid="edit-vocabulary-btn">
                                Edit Vocabulary
                                <span class="badge" id="vocabulary-count">0</span>
                            </button>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Word Replacements</label>
                                <p class="setting-help">Automatically replace specific words or phrases.</p>
                            </div>
                            <button type="button" id="edit-dictionary-btn" class="btn btn-secondary" data-testid="edit-dictionary-btn">
                                Edit Dictionary
                                <span class="badge" id="dictionary-count">0</span>
                            </button>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Text Shortcuts</label>
                                <p class="setting-help">Expand short phrases into longer text.</p>
                            </div>
                            <button type="button" id="edit-shortcuts-btn" class="btn btn-secondary" data-testid="edit-shortcuts-btn">
                                Edit Shortcuts
                                <span class="badge" id="shortcuts-count">0</span>
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Advanced Page -->
                <section class="page" id="page-advanced">
                    <!-- AI Text Cleanup Section -->
                    <div class="settings-section">
                        <h3 class="section-title">AI Text Cleanup</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Enable AI Cleanup</label>
                                <p class="setting-help">Use AI to fix grammar and improve clarity (runs locally).</p>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="ai-cleanup" aria-label="AI cleanup" data-testid="ai-cleanup">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="child-settings" id="ai-cleanup-options">
                            <!-- Hidden elements for JS compatibility -->
                            <input type="hidden" id="ollama-url" value="http://localhost:11434">
                            <input type="hidden" id="ollama-model" value="llama3.2:3b">

                            <!-- AI Status Row -->
                            <div class="setting-row toggle-row" id="ai-status-row">
                                <div class="setting-info">
                                    <label class="setting-label">AI Status</label>
                                    <p class="setting-help" id="ai-status-help">Checking AI availability...</p>
                                </div>
                                <div class="status-badge" id="ollama-status">
                                    <span class="status-indicator"></span>
                                    <span class="status-text">Checking...</span>
                                </div>
                            </div>

                            <!-- Setup Required Row (shown when AI not available) -->
                            <div class="setting-row toggle-row hidden" id="ai-setup-row">
                                <div class="setting-info">
                                    <label class="setting-label">Setup Required</label>
                                    <p class="setting-help">AI components need to be installed for this feature.</p>
                                </div>
                                <button type="button" id="setup-ai-btn" class="btn btn-primary" data-testid="setup-ai-btn">Setup AI</button>
                            </div>

                            <!-- Download Progress (shown during setup) -->
                            <div class="setting-row toggle-row hidden" id="ai-download-progress-row">
                                <div class="setting-info">
                                    <label class="setting-label">Setting Up AI</label>
                                    <p class="setting-help" id="ai-download-progress-text">Downloading components...</p>
                                </div>
                                <div class="progress-bar-container">
                                    <div class="progress-bar" id="ai-download-progress" style="width: 0%"></div>
                                </div>
                            </div>

                            <div class="setting-row toggle-row">
                                <div class="setting-info">
                                    <label class="setting-label">Cleanup Mode</label>
                                    <p class="setting-help">Choose what aspects to improve.</p>
                                </div>
                                <div id="ai-cleanup-mode" class="custom-dropdown" aria-label="Cleanup mode" data-testid="ai-cleanup-mode">
                                    <button type="button" class="custom-dropdown-button" aria-haspopup="listbox">
                                        <span class="custom-dropdown-value">Grammar Only</span>
                                        <svg class="custom-dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                    </button>
                                    <div class="custom-dropdown-menu" role="listbox">
                                        <div class="custom-dropdown-option selected" data-value="grammar" role="option">Grammar Only</div>
                                        <div class="custom-dropdown-option" data-value="formality" role="option">Formality Only</div>
                                        <div class="custom-dropdown-option" data-value="both" role="option">Grammar + Formality</div>
                                    </div>
                                </div>
                            </div>

                            <div class="setting-row toggle-row" id="formality-row">
                                <div class="setting-info">
                                    <label class="setting-label">Formality Level</label>
                                    <p class="setting-help">Target formality for adjusted text.</p>
                                </div>
                                <div id="ai-formality-level" class="custom-dropdown" aria-label="Formality level" data-testid="ai-formality-level">
                                    <button type="button" class="custom-dropdown-button" aria-haspopup="listbox">
                                        <span class="custom-dropdown-value">Professional</span>
                                        <svg class="custom-dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                    </button>
                                    <div class="custom-dropdown-menu" role="listbox">
                                        <div class="custom-dropdown-option" data-value="casual" role="option">Casual</div>
                                        <div class="custom-dropdown-option selected" data-value="professional" role="option">Professional</div>
                                        <div class="custom-dropdown-option" data-value="formal" role="option">Formal</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Maintenance Section -->
                    <div class="settings-section">
                        <h3 class="section-title">Maintenance</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Start with Windows</label>
                                <p class="setting-help">Launch MurmurTone automatically when you log in.</p>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="start-with-windows" aria-label="Start with Windows" data-testid="start-with-windows">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Transcription History</label>
                                <p class="setting-help">View and search past transcriptions.</p>
                            </div>
                            <button type="button" id="view-history-btn" class="btn btn-secondary" data-testid="view-history-btn">View History</button>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Reset Settings</label>
                                <p class="setting-help">Restore all settings to their default values.</p>
                            </div>
                            <button type="button" id="reset-defaults-btn" class="btn btn-danger" data-testid="reset-defaults-btn">Reset to Defaults</button>
                        </div>
                    </div>
                </section>

                <!-- About Page -->
                <section class="page" id="page-about">
                    <!-- App Info Section -->
                    <div class="settings-section">
                        <h3 class="section-title">App Info</h3>

                        <div class="about-header">
                            <img src="assets/logo.png" alt="MurmurTone" class="about-logo">
                            <div class="about-text">
                                <h4 class="about-name">MurmurTone</h4>
                                <p class="about-tagline">Voice-to-text for your desktop</p>
                            </div>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Version</label>
                                <p class="setting-help">Current application version.</p>
                            </div>
                            <span class="setting-value" id="about-version">1.0.0</span>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Check for Updates on Startup</label>
                                <p class="setting-help">Check for new versions when app launches. Requires internet connection.</p>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="auto-update" aria-label="Auto update" data-testid="auto-update">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Check for Updates</label>
                                <p class="setting-help">Check if a newer version is available.</p>
                            </div>
                            <button type="button" id="check-updates-btn" class="btn btn-secondary" data-testid="check-updates-btn">Check Now</button>
                        </div>
                    </div>

                    <!-- License Section -->
                    <div class="settings-section">
                        <h3 class="section-title">License</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">License Status</label>
                                <p class="setting-help">Your current license type.</p>
                            </div>
                            <div class="status-badge success" id="license-status">
                                <span class="status-indicator"></span>
                                <span class="status-text" id="license-text">Active</span>
                            </div>
                        </div>

                        <div class="setting-row toggle-row hidden" id="license-input-row">
                            <div class="setting-info">
                                <label class="setting-label">License Key</label>
                                <p class="setting-help">Enter your license key to activate.</p>
                            </div>
                            <div class="input-with-button">
                                <input type="text" id="license-key" class="text-input"
                                    placeholder="Enter your license key..."
                                    aria-label="License key"
                                    data-testid="license-key">
                                <button type="button" id="activate-license-btn" class="btn btn-primary" data-testid="activate-license-btn">Activate</button>
                            </div>
                        </div>

                        <div class="setting-row toggle-row hidden" id="purchase-row">
                            <div class="setting-info">
                                <label class="setting-label">Purchase</label>
                                <p class="setting-help">Get a full license to unlock all features.</p>
                            </div>
                            <button type="button" id="purchase-btn" class="btn btn-primary" data-testid="purchase-btn">Buy Now</button>
                        </div>
                    </div>

                    <!-- Links Section -->
                    <div class="settings-section">
                        <h3 class="section-title">Links</h3>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Documentation</label>
                                <p class="setting-help">Read the user guide and tutorials.</p>
                            </div>
                            <a href="https://murmurtone.com/docs" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">Open Docs</a>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Report Issue</label>
                                <p class="setting-help">Found a bug? Let us know.</p>
                            </div>
                            <a href="https://murmurtone.com/support" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">Report Bug</a>
                        </div>

                        <div class="setting-row toggle-row">
                            <div class="setting-info">
                                <label class="setting-label">Privacy Policy</label>
                                <p class="setting-help">How we handle your data.</p>
                            </div>
                            <a href="https://murmurtone.com/privacy" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">View Policy</a>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Welcome Banner (First Run) -->
    <div class="welcome-banner" id="welcome-banner">
        <div class="welcome-content">
            <div class="welcome-icon">
                <img src="assets/logo.png" alt="MurmurTone Logo" class="welcome-logo">
            </div>
            <h2 class="welcome-title">Welcome to MurmurTone</h2>
            <p class="welcome-description">
                AI-powered voice-to-text transcription.
                Press your hotkey to start recording, and your speech will be transcribed instantly.
            </p>
            <div class="welcome-features">
                <div class="welcome-feature">
                    <span class="feature-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="2" y="4" width="20" height="16" rx="2"/>
                            <path d="M6 8h.01M10 8h.01M14 8h.01M18 8h.01M8 12h.01M12 12h.01M16 12h.01M6 16h8"/>
                        </svg>
                    </span>
                    <span>Default hotkey: <strong>Ctrl+Shift+Space</strong></span>
                </div>
                <div class="welcome-feature">
                    <span class="feature-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                            <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                            <line x1="12" y1="19" x2="12" y2="23"/>
                            <line x1="8" y1="23" x2="16" y2="23"/>
                        </svg>
                    </span>
                    <span>Works with any microphone</span>
                </div>
                <div class="welcome-feature">
                    <span class="feature-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                        </svg>
                    </span>
                    <span>Transcription appears at your cursor</span>
                </div>
            </div>
            <button class="btn btn-primary welcome-btn" onclick="hideWelcomeBanner()">
                Get Started
            </button>
            <label class="welcome-checkbox checkbox-label">
                <input type="checkbox" id="dont-show-again" checked>
                <span class="checkbox-custom"></span>
                <span>Don't show this again</span>
            </label>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Dictionary Editor Modal -->
    <div class="modal-overlay" id="dictionary-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Edit Word Replacements</h3>
                <button type="button" class="modal-close" id="dictionary-modal-close" title="Close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <p class="modal-description">Define word replacements. When the original word is transcribed, it will automatically be replaced.</p>
                <div class="modal-table-container">
                    <table class="editor-table" id="dictionary-table">
                        <thead>
                            <tr>
                                <th>Original Word</th>
                                <th>Replacement</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="dictionary-tbody">
                            <!-- Rows added dynamically -->
                        </tbody>
                    </table>
                </div>
                <button type="button" class="btn btn-secondary" id="add-dictionary-row">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Add Row
                </button>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="dictionary-cancel">Cancel</button>
                <button type="button" class="btn btn-primary" id="dictionary-save">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Shortcuts Editor Modal -->
    <div class="modal-overlay" id="shortcuts-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Edit Text Shortcuts</h3>
                <button type="button" class="modal-close" id="shortcuts-modal-close" title="Close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <p class="modal-description">Create trigger phrases that expand into longer text. Say the trigger to insert the expansion.</p>
                <div class="modal-table-container">
                    <table class="editor-table" id="shortcuts-table">
                        <thead>
                            <tr>
                                <th>Trigger Phrase</th>
                                <th>Expansion Text</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="shortcuts-tbody">
                            <!-- Rows added dynamically -->
                        </tbody>
                    </table>
                </div>
                <button type="button" class="btn btn-secondary" id="add-shortcuts-row">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Add Row
                </button>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="shortcuts-cancel">Cancel</button>
                <button type="button" class="btn btn-primary" id="shortcuts-save">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- History Modal -->
    <div class="modal-overlay" id="history-modal">
        <div class="modal modal-large">
            <div class="modal-header">
                <h3 class="modal-title">Transcription History</h3>
                <button type="button" class="modal-close" id="history-modal-close" title="Close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <p class="modal-description">Your recent transcriptions are shown below.</p>
                <div class="history-list" id="history-list">
                    <!-- History items added dynamically -->
                </div>
                <p class="history-empty hidden" id="history-empty">No transcription history available.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="history-copy" disabled>Copy Selected</button>
                <button type="button" class="btn btn-danger" id="history-clear">Clear History</button>
                <button type="button" class="btn btn-secondary" id="history-export">Export to File</button>
                <button type="button" class="btn btn-primary" id="history-close">Close</button>
            </div>
        </div>
    </div>

    <!-- Export Format Modal -->
    <div class="modal-overlay" id="export-format-modal">
        <div class="modal modal-small">
            <div class="modal-header">
                <h3 class="modal-title">Export Format</h3>
                <button type="button" class="modal-close" id="export-format-close" title="Close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <p class="modal-description">Select export format:</p>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="export-format" value="txt" checked>
                        <span>Plain Text (.txt)</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="export-format" value="csv">
                        <span>CSV with timestamps (.csv)</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="export-format" value="json">
                        <span>JSON with metadata (.json)</span>
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="export-format-cancel">Cancel</button>
                <button type="button" class="btn btn-primary" id="export-format-confirm">Export</button>
            </div>
        </div>
    </div>

    <!-- Vocabulary Editor Modal -->
    <div class="modal-overlay" id="vocabulary-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Edit Custom Vocabulary</h3>
                <button type="button" class="modal-close" id="vocabulary-modal-close" title="Close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <p class="setting-help">Add words that should always be recognized correctly, like names or technical terms.</p>
                <div class="add-item-form">
                    <input type="text" id="vocabulary-input" class="text-input" placeholder="Add a word..." aria-label="New vocabulary word">
                    <button type="button" id="add-vocabulary-btn" class="btn btn-primary">Add</button>
                </div>
                <div class="item-list" id="vocabulary-list">
                    <!-- Items added dynamically -->
                </div>
                <p class="empty-state hidden" id="vocabulary-empty">No custom vocabulary added yet.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="vocabulary-cancel">Cancel</button>
                <button type="button" class="btn btn-primary" id="vocabulary-save">Save</button>
            </div>
        </div>
    </div>

    <!-- Filler Words Editor Modal -->
    <div class="modal-overlay" id="fillers-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Edit Custom Filler Words</h3>
                <button type="button" class="modal-close" id="fillers-modal-close" title="Close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <p class="setting-help">Add words that should be filtered out from transcriptions.</p>
                <div class="add-item-form">
                    <input type="text" id="filler-input" class="text-input" placeholder="Add a word..." aria-label="New filler word">
                    <button type="button" id="add-filler-btn" class="btn btn-primary">Add</button>
                </div>
                <div class="item-list" id="filler-list">
                    <!-- Items added dynamically -->
                </div>
                <p class="empty-state hidden" id="filler-empty">No custom filler words added.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="fillers-cancel">Cancel</button>
                <button type="button" class="btn btn-primary" id="fillers-save">Save</button>
            </div>
        </div>
    </div>

    <!-- Confirm Reset Modal -->
    <div class="modal-overlay" id="confirm-modal">
        <div class="modal modal-small">
            <div class="modal-header">
                <h3 class="modal-title">Reset Settings</h3>
                <button type="button" class="modal-close" id="confirm-modal-close" title="Close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body modal-body-centered">
                <div class="modal-icon warning">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="48" height="48">
                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                        <line x1="12" y1="9" x2="12" y2="13"/>
                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                </div>
                <p class="confirm-message">Are you sure you want to reset all settings to their default values? This cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="confirm-cancel">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirm-reset">Reset Settings</button>
            </div>
        </div>
    </div>

    <!-- Update Available Modal -->
    <div class="modal-overlay" id="update-modal" style="display: none;">
        <div class="modal modal-small">
            <div class="modal-header">
                <h3 class="modal-title">Update Available</h3>
                <button type="button" class="modal-close" id="update-modal-close" title="Close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body modal-body-centered">
                <div class="modal-icon info">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="48" height="48">
                        <path d="M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                        <path d="M12 8v4"/>
                        <path d="M12 16h.01"/>
                    </svg>
                </div>
                <p class="update-version-text">Version <strong id="update-version-number"></strong> is now available</p>
                <p class="update-current-text">You're currently running version <strong id="current-version-number"></strong></p>
                <p class="update-info-text">This update includes bug fixes and new features.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="update-later-btn">Remind Me Later</button>
                <button type="button" class="btn btn-primary" id="update-download-btn">Download Update</button>
            </div>
        </div>
    </div>

    <script src="settings.js"></script>
</body>
</html>
